name: Deploy Site on push
on:
  push:
    branches:
      - main
jobs:
  web-deploy:
    name: Deploy
    env:
      REACT_APP_API_URL: ${{ secrets.REACT_APP_API_URL }}
    runs-on: ubuntu-latest
    steps:
    - name: Get the latest code
      uses: actions/checkout@v2.3.2
    - uses: actions/setup-node@master
    - name: Installing project dependencies
      run: npm install
    - name: Building the project
      run: npm run build
    - name: üìÇ Sync files
      uses: up9cloud/action-rsync@master
      env:
        USER: ${{ secrets.FTP_USERNAME }}
        HOST: ${{ secrets.SERVER_IP }}
        PORT: ${{ secrets.FTP_PORT }}
        TARGET: '/var/www/html'
        SOURCE: './build/'
        KEY: ${{ secrets.SSH_PRIVATE_KEY }}
        ARGS: -azv --delete --exclude=/.htaccess
        PRE_SCRIPT: "echo üèÅ Start at: && date -u"
        POST_SCRIPT: "echo ‚úÖ Done at: && date -u"
